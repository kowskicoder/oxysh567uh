import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useQuery } from '@tanstack/react-query';
import { useAppStore } from '../../store/useAppStore';
import { apiClient } from '../../lib/api';
import { ArrowDownLeft, ArrowUpRight, Plus, ArrowLeftRight, Wallet, ShoppingCart, TrendingUp, Download } from 'lucide-react';
import { useState } from 'react';
import DepositModal from '../modals/DepositModal';
import WithdrawModal from '../modals/WithdrawModal';
import { formatBalance } from '../../utils/currencyUtils';
import { formatDistanceToNow } from 'date-fns';
import { motion, AnimatePresence } from 'framer-motion';
export default function WalletTab() {
    const { user } = useAppStore();
    const [showDepositModal, setShowDepositModal] = useState(false);
    const [showWithdrawModal, setShowWithdrawModal] = useState(false);
    const { data: wallet, isLoading } = useQuery({
        queryKey: ['wallet'],
        queryFn: () => apiClient.getWallet(),
    });
    if (!user)
        return null;
    const currentBalance = wallet?.wallet?.balance || 0;
    const currentCoins = wallet?.wallet?.coins || 0;
    return (_jsx("div", { className: "min-h-screen bg-dark-bg theme-transition pb-[100px]", children: _jsxs("div", { className: "max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8", children: [_jsxs("div", { className: "grid grid-cols-2 gap-3 mb-6", children: [_jsxs(motion.div, { initial: { opacity: 0, y: 20 }, animate: { opacity: 1, y: 0 }, whileHover: { scale: 1.02 }, className: "bg-gradient-to-br from-emerald-900/40 to-teal-900/40 rounded-2xl p-4 border border-emerald-800/30 shadow-lg backdrop-blur", children: [_jsxs("div", { className: "flex items-center justify-between mb-3", children: [_jsx("div", { className: "w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-400 to-teal-500 flex items-center justify-center shadow-lg", children: _jsx(Wallet, { className: "w-5 h-5 text-white" }) }), _jsxs("div", { className: "flex items-center gap-1 text-emerald-400", children: [_jsx(TrendingUp, { className: "w-3 h-3" }), _jsx("span", { className: "text-xs font-medium", children: "Active" })] })] }), _jsx("p", { className: "text-xs text-emerald-300 font-medium mb-1", children: "Main Balance" }), _jsx("h3", { className: "text-2xl font-bold text-white", children: formatBalance(currentBalance) })] }), _jsxs(motion.div, { initial: { opacity: 0, y: 20 }, animate: { opacity: 1, y: 0 }, transition: { delay: 0.1 }, whileHover: { scale: 1.02 }, className: "bg-gradient-to-br from-amber-900/40 to-orange-900/40 rounded-2xl p-4 border border-amber-800/30 shadow-lg backdrop-blur", children: [_jsxs("div", { className: "flex items-center justify-between mb-3", children: [_jsx("div", { className: "w-10 h-10 rounded-xl bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center shadow-lg", children: _jsx(ShoppingCart, { className: "w-5 h-5 text-white" }) }), _jsx(motion.div, { className: "w-6 h-6 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center shadow-lg", children: _jsx("span", { className: "text-xs font-bold text-white", children: currentCoins > 999 ? "K+" : "" }) })] }), _jsx("p", { className: "text-xs text-amber-300 font-medium mb-1", children: "Bantah Bucks" }), _jsx("h3", { className: "text-2xl font-bold text-white", children: currentCoins.toLocaleString() })] })] }), _jsxs(motion.div, { initial: { opacity: 0, y: 20 }, animate: { opacity: 1, y: 0 }, transition: { delay: 0.2 }, className: "bg-slate-800/50 rounded-2xl p-4 border border-slate-700/50 mb-6 backdrop-blur", children: [_jsx("h3", { className: "text-base font-bold text-white mb-4", children: "Quick Actions" }), _jsxs("div", { className: "grid grid-cols-3 gap-2", children: [_jsx(motion.button, { whileHover: { scale: 1.05 }, whileTap: { scale: 0.95 }, onClick: () => setShowDepositModal(true), className: "bg-gradient-to-br from-blue-900/40 to-blue-800/40 rounded-xl p-3 border border-blue-700/50 cursor-pointer hover:border-blue-600/75 transition-colors", children: _jsxs("div", { className: "flex flex-col items-center gap-2 text-center", children: [_jsx("div", { className: "w-8 h-8 rounded-xl bg-gradient-to-br from-blue-400 to-blue-500 flex items-center justify-center shadow-lg", children: _jsx(Plus, { className: "w-4 h-4 text-white" }) }), _jsx("h4", { className: "font-semibold text-blue-300 text-xs", children: "Add Money" })] }) }), _jsx(motion.button, { whileHover: { scale: 1.05 }, whileTap: { scale: 0.95 }, onClick: () => setShowWithdrawModal(true), className: "bg-gradient-to-br from-orange-900/40 to-orange-800/40 rounded-xl p-3 border border-orange-700/50 cursor-pointer hover:border-orange-600/75 transition-colors", children: _jsxs("div", { className: "flex flex-col items-center gap-2 text-center", children: [_jsx("div", { className: "w-8 h-8 rounded-xl bg-gradient-to-br from-orange-400 to-orange-500 flex items-center justify-center shadow-lg", children: _jsx(Download, { className: "w-4 h-4 text-white" }) }), _jsx("h4", { className: "font-semibold text-orange-300 text-xs", children: "Withdraw" })] }) }), _jsx(motion.div, { whileHover: { scale: 1.05 }, className: "bg-slate-700/30 rounded-xl p-3 border border-slate-700/50 opacity-40 cursor-not-allowed", children: _jsxs("div", { className: "flex flex-col items-center gap-2 text-center", children: [_jsx("div", { className: "w-8 h-8 rounded-xl bg-slate-600 flex items-center justify-center", children: _jsx(ArrowLeftRight, { className: "w-4 h-4 text-slate-400" }) }), _jsx("h4", { className: "font-semibold text-slate-400 text-xs", children: "Swap" })] }) })] })] }), _jsxs("div", { className: "grid grid-cols-2 gap-4 mb-6", children: [_jsxs(motion.div, { initial: { opacity: 0 }, animate: { opacity: 1 }, transition: { delay: 0.3 }, whileHover: { scale: 1.02 }, className: "bg-gradient-to-br from-emerald-900/40 to-teal-900/40 rounded-2xl p-4 border border-emerald-800/30 backdrop-blur", children: [_jsx("p", { className: "text-emerald-300 text-sm mb-2 font-medium", children: "Total Earned" }), _jsx("p", { className: "text-2xl font-bold text-emerald-100", children: formatBalance(wallet?.wallet?.totalEarned || 0) })] }), _jsxs(motion.div, { initial: { opacity: 0 }, animate: { opacity: 1 }, transition: { delay: 0.4 }, whileHover: { scale: 1.02 }, className: "bg-gradient-to-br from-red-900/40 to-rose-900/40 rounded-2xl p-4 border border-red-800/30 backdrop-blur", children: [_jsx("p", { className: "text-red-300 text-sm mb-2 font-medium", children: "Total Spent" }), _jsx("p", { className: "text-2xl font-bold text-red-100", children: formatBalance(wallet?.wallet?.totalSpent || 0) })] })] }), _jsxs(motion.div, { initial: { opacity: 0, y: 20 }, animate: { opacity: 1, y: 0 }, transition: { delay: 0.5 }, children: [_jsxs("h3", { className: "text-lg font-bold text-white mb-4 flex items-center gap-2", children: [_jsx("div", { className: "w-8 h-8 rounded-lg bg-purple-600/30 border border-purple-500/50 flex items-center justify-center", children: _jsx(TrendingUp, { size: 18, className: "text-purple-400" }) }), "Recent Transactions"] }), _jsx("div", { className: "space-y-2", children: isLoading ? (_jsx("div", { className: "bg-slate-800/50 rounded-2xl p-6 text-center text-slate-400 border border-slate-700/50 backdrop-blur", children: "Loading transactions..." })) : wallet?.recentTransactions?.length ? (_jsx(AnimatePresence, { children: wallet.recentTransactions.map((tx, idx) => (_jsxs(motion.div, { initial: { opacity: 0, x: -20 }, animate: { opacity: 1, x: 0 }, transition: { delay: 0.5 + idx * 0.05 }, whileHover: { scale: 1.01 }, className: `rounded-xl p-4 border flex items-center justify-between backdrop-blur transition-colors ${tx.type === 'deposit'
                                        ? 'bg-green-900/20 border-green-800/30 hover:border-green-700/50'
                                        : 'bg-red-900/20 border-red-800/30 hover:border-red-700/50'}`, children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsx(motion.div, { whileHover: { rotate: 10 }, className: `p-3 rounded-lg ${tx.type === 'deposit'
                                                        ? 'bg-green-900/40'
                                                        : 'bg-red-900/40'}`, children: tx.type === 'deposit' ? (_jsx(ArrowDownLeft, { className: `w-5 h-5 ${tx.type === 'deposit' ? 'text-green-400' : 'text-red-400'}` })) : (_jsx(ArrowUpRight, { className: `w-5 h-5 ${tx.type === 'deposit' ? 'text-green-400' : 'text-red-400'}` })) }), _jsxs("div", { children: [_jsx("p", { className: "font-semibold text-white capitalize", children: tx.type.replace('_', ' ') }), _jsx("p", { className: "text-sm text-slate-400", children: formatDistanceToNow(new Date(tx.createdAt), { addSuffix: true }) })] })] }), _jsx("div", { className: "text-right", children: _jsxs("p", { className: `font-bold ${tx.amount > 0 ? 'text-green-400' : 'text-red-400'}`, children: [tx.amount > 0 ? '+' : '', formatBalance(Math.abs(tx.amount))] }) })] }, tx.id))) })) : (_jsx("div", { className: "bg-slate-800/50 rounded-2xl p-6 text-center text-slate-400 border border-slate-700/50 backdrop-blur", children: "No transactions yet" })) })] }), showDepositModal && (_jsx(DepositModal, { onClose: () => setShowDepositModal(false) })), showWithdrawModal && (_jsx(WithdrawModal, { balance: currentBalance, onClose: () => setShowWithdrawModal(false) }))] }) }));
}
